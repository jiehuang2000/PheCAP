<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example: <code>ehrdata</code> • PheCAP</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example: &lt;code&gt;ehrdata&lt;/code&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PheCAP</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/main-steps.html">Main Steps</a>
</li>
<li>
  <a href="../articles/sim-data.html">Example</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/parse-health/PheCAP">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Example: <code>ehrdata</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/parse-health/PheCAP/blob/master/vignettes/example2.Rmd"><code>vignettes/example2.Rmd</code></a></small>
      <div class="hidden name"><code>example2.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(PheCAP)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">dim</span>(ehrdata)</a></code></pre></div>
<pre><code>## [1] 10000   588</code></pre>
<p>The <code>ehrdata</code> dataset in the <code>PheCAP</code> package contains the following variables.</p>
<ul>
<li><p>ICD feature: <code>main_ICD</code>, <code>COD1</code>, <code>COD2</code>, …, <code>COD10</code></p></li>
<li><p>NLP feature: <code>main_NLP</code>, <code>NLP1</code>, <code>NLP2</code>, …, <code>NLP574</code></p></li>
<li><p>HU feature: <code>healthcare_utlization</code></p></li>
<li><p>Phenotype: <code>label</code></p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">patient_id &lt;-<span class="st"> </span><span class="kw">rownames</span>(ehrdata)</a></code></pre></div>
<p>ICD feature: <code>main_ICD</code>, <code>COD1</code>, <code>COD2</code>, …, <code>COD10</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">icd_feature &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="dt">PatientID =</span> patient_id,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="dt">main_ICD =</span> ehrdata[, <span class="st">"main_ICD"</span>],</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  ehrdata[, <span class="kw">substr</span>(<span class="kw">colnames</span>(ehrdata), <span class="dv">1</span>, <span class="dv">3</span>) <span class="op">==</span><span class="st"> "COD"</span>])</a></code></pre></div>
<p>NLP feature: <code>main_NLP</code>, <code>NLP1</code>, <code>NLP2</code>, …, <code>NLP574</code></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">nlp_feature &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  <span class="dt">PatientID =</span> patient_id,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="dt">main_NLP =</span> ehrdata[, <span class="st">"main_NLP"</span>],</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  ehrdata[, <span class="kw">substr</span>(<span class="kw">colnames</span>(ehrdata), <span class="dv">1</span>, <span class="dv">3</span>) <span class="op">==</span><span class="st"> "NLP"</span>])</a></code></pre></div>
<p>HU feature: <code>healthcare_utlization</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">hu_feature &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="dt">PatientID =</span> patient_id,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="dt">healthcare_utlization =</span> ehrdata[, <span class="st">"healthcare_utlization"</span>])</a></code></pre></div>
<p>Phenotype (n = 181)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">id_label &lt;-<span class="st"> </span>patient_id[<span class="op">!</span><span class="kw">is.na</span>(ehrdata<span class="op">$</span>label)]</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">id_label_training &lt;-<span class="st"> </span><span class="kw">sample</span>(id_label, <span class="kw">round</span>(<span class="kw">length</span>(id_label)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">id_label_validation &lt;-<span class="st"> </span><span class="kw">setdiff</span>(id_label, id_label_training)</a></code></pre></div>
<p>Training Phenotype (n = 90)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">training_label &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  <span class="dt">PatientID =</span> id_label_training, </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  <span class="dt">label =</span> ehrdata[patient_id <span class="op">%in%</span><span class="st"> </span>id_label_training, <span class="st">"label"</span>])</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw">table</span>(training_label<span class="op">$</span>label)</a></code></pre></div>
<pre><code>## 
##  0  1 
## 27 63</code></pre>
<p>Validation Phenotype (n = 91)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">validation_label &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">  <span class="dt">PatientID =</span> id_label_validation, </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  <span class="dt">label =</span> ehrdata[patient_id <span class="op">%in%</span><span class="st"> </span>id_label_validation, <span class="st">"label"</span>])</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw">table</span>(validation_label<span class="op">$</span>label)</a></code></pre></div>
<pre><code>## 
##  0  1 
## 35 56</code></pre>
<p>Define features and labels used for phenotyping.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PhecapData.html">PhecapData</a></span>(</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  <span class="dt">icd_feature =</span> icd_feature,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="dt">nlp_feature =</span> nlp_feature,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">  <span class="dt">hu_feature =</span> hu_feature,</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">  <span class="dt">training_label =</span> training_label,</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">  <span class="dt">validation_label =</span> validation_label,</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">  <span class="dt">patient_index =</span> <span class="st">"PatientID"</span>)</a></code></pre></div>
<p>Specify the surrogate used for surrogate-assisted feature extraction (SAFE). The typical way is to specify a main ICD code, a main NLP CUI, as well as their combination. The default lower_cutoff is 1, and the default upper_cutoff is 10. In some cases one may want to define surrogate through lab test. Feel free to change the cutoffs based on domain knowledge.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">surrogates &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  <span class="kw"><a href="../reference/PhecapSurrogate.html">PhecapSurrogate</a></span>(<span class="dt">variable_names =</span> <span class="st">"main_ICD"</span>, </a>
<a class="sourceLine" id="cb15-3" data-line-number="3">                  <span class="dt">lower_cutoff =</span> <span class="dv">1</span>, <span class="dt">upper_cutoff =</span> <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  <span class="kw"><a href="../reference/PhecapSurrogate.html">PhecapSurrogate</a></span>(<span class="dt">variable_names =</span> <span class="st">"main_NLP"</span>, </a>
<a class="sourceLine" id="cb15-5" data-line-number="5">                  <span class="dt">lower_cutoff =</span> <span class="dv">1</span>, <span class="dt">upper_cutoff =</span> <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">  <span class="kw"><a href="../reference/PhecapSurrogate.html">PhecapSurrogate</a></span>(<span class="dt">variable_names =</span> <span class="kw">c</span>(<span class="st">"main_ICD"</span>, <span class="st">"main_NLP"</span>), </a>
<a class="sourceLine" id="cb15-7" data-line-number="7">                  <span class="dt">lower_cutoff =</span> <span class="dv">1</span>, <span class="dt">upper_cutoff =</span> <span class="dv">10</span>))</a></code></pre></div>
<p>Run surrogate-assisted feature extraction (SAFE) and show result.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">feature_selected &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phecap_run_feature_extraction.html">phecap_run_feature_extraction</a></span>(data, surrogates)</a></code></pre></div>
<pre><code>##             main_ICD main_NLP main_ICD&amp;main_NLP
## NumCases         950     1505              1860
## NumControls     7237     7158              6138
## Using surrogate main_ICD 
## Subsample 1 
## Subsample 11 
## Subsample 21 
## Subsample 31 
## Subsample 41 
## Subsample 51 
## Subsample 61 
## Subsample 71 
## Subsample 81 
## Subsample 91 
## Subsample 101 
## Subsample 111 
## Subsample 121 
## Subsample 131 
## Subsample 141 
## Subsample 151 
## Subsample 161 
## Subsample 171 
## Subsample 181 
## Subsample 191 
## Subsample 200 
## Using surrogate main_NLP 
## Subsample 1 
## Subsample 11 
## Subsample 21 
## Subsample 31 
## Subsample 41 
## Subsample 51 
## Subsample 61 
## Subsample 71 
## Subsample 81 
## Subsample 91 
## Subsample 101 
## Subsample 111 
## Subsample 121 
## Subsample 131 
## Subsample 141 
## Subsample 151 
## Subsample 161 
## Subsample 171 
## Subsample 181 
## Subsample 191 
## Subsample 200 
## Using surrogate main_ICD&amp;main_NLP 
## Subsample 1 
## Subsample 11 
## Subsample 21 
## Subsample 31 
## Subsample 41 
## Subsample 51 
## Subsample 61 
## Subsample 71 
## Subsample 81 
## Subsample 91 
## Subsample 101 
## Subsample 111 
## Subsample 121 
## Subsample 131 
## Subsample 141 
## Subsample 151 
## Subsample 161 
## Subsample 171 
## Subsample 181 
## Subsample 191 
## Subsample 200</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">print</span>(feature_selected)</a></code></pre></div>
<pre><code>## [1] "main_ICD" "main_NLP" "NLP56"    "NLP93"    "NLP160"   "NLP161"  
## [7] "NLP243"   "NLP306"   "NLP403"  
## attr(,"frequency")
##              main_ICD                  COD1                  COD2 
##           1.000000000           0.011666667           0.000000000 
##                  COD3                  COD4                  COD5 
##           0.001666667           0.006666667           0.000000000 
##                  COD6                  COD7                  COD8 
##           0.066666667           0.000000000           0.005000000 
##                  COD9                 COD10              main_NLP 
##           0.000000000           0.130000000           1.000000000 
##                  NLP1                  NLP2                  NLP3 
##           0.108333333           0.006666667           0.000000000 
##                  NLP4                  NLP5                  NLP6 
##           0.208333333           0.020000000           0.471666667 
##                  NLP7                  NLP8                  NLP9 
##           0.005000000           0.065000000           0.255000000 
##                 NLP10                 NLP11                 NLP12 
##           0.005000000           0.000000000           0.000000000 
##                 NLP13                 NLP14                 NLP15 
##           0.000000000           0.085000000           0.003333333 
##                 NLP16                 NLP17                 NLP18 
##           0.261666667           0.021666667           0.000000000 
##                 NLP19                 NLP20                 NLP21 
##           0.005000000           0.000000000           0.000000000 
##                 NLP22                 NLP23                 NLP24 
##           0.020000000           0.001666667           0.098333333 
##                 NLP25                 NLP26                 NLP27 
##           0.018333333           0.081666667           0.003333333 
##                 NLP28                 NLP29                 NLP30 
##           0.001666667           0.001666667           0.000000000 
##                 NLP31                 NLP32                 NLP33 
##           0.076666667           0.000000000           0.000000000 
##                 NLP34                 NLP35                 NLP36 
##           0.000000000           0.000000000           0.011666667 
##                 NLP37                 NLP38                 NLP39 
##           0.005000000           0.000000000           0.010000000 
##                 NLP40                 NLP41                 NLP42 
##           0.043333333           0.145000000           0.001666667 
##                 NLP43                 NLP44                 NLP45 
##           0.010000000           0.000000000           0.010000000 
##                 NLP46                 NLP47                 NLP48 
##           0.001666667           0.000000000           0.000000000 
##                 NLP49                 NLP50                 NLP51 
##           0.000000000           0.005000000           0.040000000 
##                 NLP52                 NLP53                 NLP54 
##           0.000000000           0.006666667           0.001666667 
##                 NLP55                 NLP56                 NLP57 
##           0.001666667           1.000000000           0.001666667 
##                 NLP58                 NLP59                 NLP60 
##           0.055000000           0.231666667           0.000000000 
##                 NLP61                 NLP62                 NLP63 
##           0.088333333           0.000000000           0.011666667 
##                 NLP64                 NLP65                 NLP66 
##           0.000000000           0.000000000           0.051666667 
##                 NLP67                 NLP68                 NLP69 
##           0.010000000           0.000000000           0.000000000 
##                 NLP70                 NLP71                 NLP72 
##           0.000000000           0.003333333           0.000000000 
##                 NLP73                 NLP74                 NLP75 
##           0.008333333           0.068333333           0.001666667 
##                 NLP76                 NLP77                 NLP78 
##           0.005000000           0.018333333           0.033333333 
##                 NLP79                 NLP80                 NLP81 
##           0.000000000           0.000000000           0.000000000 
##                 NLP82                 NLP83                 NLP84 
##           0.000000000           0.000000000           0.000000000 
##                 NLP85                 NLP86                 NLP87 
##           0.003333333           0.000000000           0.000000000 
##                 NLP88                 NLP89                 NLP90 
##           0.000000000           0.000000000           0.000000000 
##                 NLP91                 NLP92                 NLP93 
##           0.001666667           0.010000000           0.686666667 
##                 NLP94                 NLP95                 NLP96 
##           0.060000000           0.001666667           0.003333333 
##                 NLP97                 NLP98                 NLP99 
##           0.001666667           0.036666667           0.015000000 
##                NLP100                NLP101                NLP102 
##           0.000000000           0.000000000           0.003333333 
##                NLP103                NLP104                NLP105 
##           0.008333333           0.001666667           0.001666667 
##                NLP106                NLP107                NLP108 
##           0.001666667           0.000000000           0.001666667 
##                NLP109                NLP110                NLP111 
##           0.028333333           0.000000000           0.000000000 
##                NLP112                NLP113                NLP114 
##           0.001666667           0.000000000           0.006666667 
##                NLP115                NLP116                NLP117 
##           0.001666667           0.003333333           0.003333333 
##                NLP118                NLP119                NLP120 
##           0.001666667           0.006666667           0.000000000 
##                NLP121                NLP122                NLP123 
##           0.001666667           0.000000000           0.001666667 
##                NLP124                NLP125                NLP126 
##           0.000000000           0.001666667           0.000000000 
##                NLP127                NLP128                NLP129 
##           0.008333333           0.010000000           0.001666667 
##                NLP130                NLP131                NLP132 
##           0.060000000           0.008333333           0.030000000 
##                NLP133                NLP134                NLP135 
##           0.016666667           0.008333333           0.090000000 
##                NLP136                NLP137                NLP138 
##           0.060000000           0.008333333           0.000000000 
##                NLP139                NLP140                NLP141 
##           0.015000000           0.028333333           0.003333333 
##                NLP142                NLP143                NLP144 
##           0.001666667           0.000000000           0.000000000 
##                NLP145                NLP146                NLP147 
##           0.006666667           0.000000000           0.000000000 
##                NLP148                NLP149                NLP150 
##           0.086666667           0.000000000           0.000000000 
##                NLP151                NLP152                NLP153 
##           0.000000000           0.001666667           0.001666667 
##                NLP154                NLP155                NLP156 
##           0.000000000           0.000000000           0.006666667 
##                NLP157                NLP158                NLP159 
##           0.000000000           0.010000000           0.000000000 
##                NLP160                NLP161                NLP162 
##           0.626666667           0.623333333           0.000000000 
##                NLP163                NLP164                NLP165 
##           0.000000000           0.000000000           0.001666667 
##                NLP166                NLP167                NLP168 
##           0.001666667           0.000000000           0.003333333 
##                NLP169                NLP170                NLP171 
##           0.005000000           0.000000000           0.000000000 
##                NLP172                NLP173                NLP174 
##           0.048333333           0.006666667           0.013333333 
##                NLP175                NLP176                NLP177 
##           0.000000000           0.061666667           0.001666667 
##                NLP178                NLP179                NLP180 
##           0.003333333           0.098333333           0.001666667 
##                NLP181                NLP182                NLP183 
##           0.000000000           0.001666667           0.006666667 
##                NLP184                NLP185                NLP186 
##           0.001666667           0.021666667           0.000000000 
##                NLP187                NLP188                NLP189 
##           0.000000000           0.001666667           0.000000000 
##                NLP190                NLP191                NLP192 
##           0.000000000           0.001666667           0.000000000 
##                NLP193                NLP194                NLP195 
##           0.010000000           0.008333333           0.018333333 
##                NLP196                NLP197                NLP198 
##           0.000000000           0.000000000           0.001666667 
##                NLP199                NLP200                NLP201 
##           0.025000000           0.000000000           0.000000000 
##                NLP202                NLP203                NLP204 
##           0.060000000           0.006666667           0.000000000 
##                NLP205                NLP206                NLP207 
##           0.003333333           0.000000000           0.001666667 
##                NLP208                NLP209                NLP210 
##           0.000000000           0.001666667           0.006666667 
##                NLP211                NLP212                NLP213 
##           0.000000000           0.001666667           0.006666667 
##                NLP214                NLP215                NLP216 
##           0.000000000           0.206666667           0.005000000 
##                NLP217                NLP218                NLP219 
##           0.000000000           0.003333333           0.001666667 
##                NLP220                NLP221                NLP222 
##           0.200000000           0.001666667           0.005000000 
##                NLP223                NLP224                NLP225 
##           0.000000000           0.006666667           0.001666667 
##                NLP226                NLP227                NLP228 
##           0.000000000           0.018333333           0.013333333 
##                NLP229                NLP230                NLP231 
##           0.003333333           0.003333333           0.376666667 
##                NLP232                NLP233                NLP234 
##           0.000000000           0.001666667           0.005000000 
##                NLP235                NLP236                NLP237 
##           0.001666667           0.011666667           0.001666667 
##                NLP238                NLP239                NLP240 
##           0.006666667           0.001666667           0.000000000 
##                NLP241                NLP242                NLP243 
##           0.000000000           0.003333333           0.506666667 
##                NLP244                NLP245                NLP246 
##           0.000000000           0.005000000           0.001666667 
##                NLP247                NLP248                NLP249 
##           0.003333333           0.000000000           0.001666667 
##                NLP250                NLP251                NLP252 
##           0.000000000           0.000000000           0.003333333 
##                NLP253                NLP254                NLP255 
##           0.006666667           0.000000000           0.001666667 
##                NLP256                NLP257                NLP258 
##           0.000000000           0.000000000           0.008333333 
##                NLP259                NLP260                NLP261 
##           0.001666667           0.003333333           0.001666667 
##                NLP262                NLP263                NLP264 
##           0.005000000           0.001666667           0.006666667 
##                NLP265                NLP266                NLP267 
##           0.018333333           0.013333333           0.000000000 
##                NLP268                NLP269                NLP270 
##           0.001666667           0.000000000           0.001666667 
##                NLP271                NLP272                NLP273 
##           0.000000000           0.105000000           0.001666667 
##                NLP274                NLP275                NLP276 
##           0.396666667           0.181666667           0.006666667 
##                NLP277                NLP278                NLP279 
##           0.000000000           0.000000000           0.008333333 
##                NLP280                NLP281                NLP282 
##           0.000000000           0.001666667           0.000000000 
##                NLP283                NLP284                NLP285 
##           0.000000000           0.003333333           0.000000000 
##                NLP286                NLP287                NLP288 
##           0.010000000           0.000000000           0.003333333 
##                NLP289                NLP290                NLP291 
##           0.016666667           0.000000000           0.000000000 
##                NLP292                NLP293                NLP294 
##           0.073333333           0.006666667           0.060000000 
##                NLP295                NLP296                NLP297 
##           0.331666667           0.001666667           0.021666667 
##                NLP298                NLP299                NLP300 
##           0.005000000           0.000000000           0.003333333 
##                NLP301                NLP302                NLP303 
##           0.005000000           0.028333333           0.005000000 
##                NLP304                NLP305                NLP306 
##           0.066666667           0.001666667           0.700000000 
##                NLP307                NLP308                NLP309 
##           0.001666667           0.000000000           0.266666667 
##                NLP310                NLP311                NLP312 
##           0.060000000           0.016666667           0.016666667 
##                NLP313                NLP314                NLP315 
##           0.010000000           0.000000000           0.023333333 
##                NLP316                NLP317                NLP318 
##           0.000000000           0.000000000           0.078333333 
##                NLP319                NLP320                NLP321 
##           0.003333333           0.005000000           0.343333333 
##                NLP322                NLP323                NLP324 
##           0.003333333           0.000000000           0.001666667 
##                NLP325                NLP326                NLP327 
##           0.016666667           0.001666667           0.001666667 
##                NLP328                NLP329                NLP330 
##           0.001666667           0.010000000           0.006666667 
##                NLP331                NLP332                NLP333 
##           0.000000000           0.003333333           0.008333333 
##                NLP334                NLP335                NLP336 
##           0.003333333           0.010000000           0.001666667 
##                NLP337                NLP338                NLP339 
##           0.000000000           0.000000000           0.001666667 
##                NLP340                NLP341                NLP342 
##           0.000000000           0.000000000           0.001666667 
##                NLP343                NLP344                NLP345 
##           0.000000000           0.000000000           0.001666667 
##                NLP346                NLP347                NLP348 
##           0.001666667           0.005000000           0.000000000 
##                NLP349                NLP350                NLP351 
##           0.236666667           0.035000000           0.005000000 
##                NLP352                NLP353                NLP354 
##           0.030000000           0.015000000           0.000000000 
##                NLP355                NLP356                NLP357 
##           0.001666667           0.006666667           0.000000000 
##                NLP358                NLP359                NLP360 
##           0.001666667           0.028333333           0.006666667 
##                NLP361                NLP362                NLP363 
##           0.026666667           0.000000000           0.028333333 
##                NLP364                NLP365                NLP366 
##           0.000000000           0.010000000           0.000000000 
##                NLP367                NLP368                NLP369 
##           0.003333333           0.001666667           0.001666667 
##                NLP370                NLP371                NLP372 
##           0.005000000           0.005000000           0.001666667 
##                NLP373                NLP374                NLP375 
##           0.000000000           0.006666667           0.000000000 
##                NLP376                NLP377                NLP378 
##           0.000000000           0.000000000           0.005000000 
##                NLP379                NLP380                NLP381 
##           0.000000000           0.010000000           0.001666667 
##                NLP382                NLP383                NLP384 
##           0.001666667           0.003333333           0.003333333 
##                NLP385                NLP386                NLP387 
##           0.000000000           0.001666667           0.001666667 
##                NLP388                NLP389                NLP390 
##           0.000000000           0.001666667           0.005000000 
##                NLP391                NLP392                NLP393 
##           0.001666667           0.000000000           0.000000000 
##                NLP394                NLP395                NLP396 
##           0.008333333           0.011666667           0.001666667 
##                NLP397                NLP398                NLP399 
##           0.001666667           0.005000000           0.001666667 
##                NLP400                NLP401                NLP402 
##           0.000000000           0.226666667           0.000000000 
##                NLP403                NLP404                NLP405 
##           0.585000000           0.000000000           0.000000000 
##                NLP406                NLP407                NLP408 
##           0.001666667           0.001666667           0.000000000 
##                NLP409                NLP410                NLP411 
##           0.000000000           0.001666667           0.000000000 
##                NLP412                NLP413                NLP414 
##           0.000000000           0.010000000           0.005000000 
##                NLP415                NLP416                NLP417 
##           0.003333333           0.003333333           0.005000000 
##                NLP418                NLP419                NLP420 
##           0.001666667           0.001666667           0.006666667 
##                NLP421                NLP422                NLP423 
##           0.000000000           0.000000000           0.005000000 
##                NLP424                NLP425                NLP426 
##           0.005000000           0.005000000           0.008333333 
##                NLP427                NLP428                NLP429 
##           0.001666667           0.003333333           0.006666667 
##                NLP430                NLP431                NLP432 
##           0.006666667           0.001666667           0.001666667 
##                NLP433                NLP434                NLP435 
##           0.000000000           0.150000000           0.006666667 
##                NLP436                NLP437                NLP438 
##           0.021666667           0.003333333           0.001666667 
##                NLP439                NLP440                NLP441 
##           0.000000000           0.001666667           0.000000000 
##                NLP442                NLP443                NLP444 
##           0.000000000           0.000000000           0.000000000 
##                NLP445                NLP446                NLP447 
##           0.006666667           0.116666667           0.000000000 
##                NLP448                NLP449                NLP450 
##           0.000000000           0.001666667           0.003333333 
##                NLP451                NLP452                NLP453 
##           0.038333333           0.001666667           0.008333333 
##                NLP454                NLP455                NLP456 
##           0.003333333           0.000000000           0.271666667 
##                NLP457                NLP458                NLP459 
##           0.003333333           0.005000000           0.001666667 
##                NLP460                NLP461                NLP462 
##           0.003333333           0.001666667           0.010000000 
##                NLP463                NLP464                NLP465 
##           0.001666667           0.003333333           0.001666667 
##                NLP466                NLP467                NLP468 
##           0.003333333           0.003333333           0.001666667 
##                NLP469                NLP470                NLP471 
##           0.000000000           0.001666667           0.000000000 
##                NLP472                NLP473                NLP474 
##           0.001666667           0.018333333           0.005000000 
##                NLP475                NLP476                NLP477 
##           0.005000000           0.000000000           0.000000000 
##                NLP478                NLP479                NLP480 
##           0.006666667           0.001666667           0.010000000 
##                NLP481                NLP482                NLP483 
##           0.001666667           0.051666667           0.001666667 
##                NLP484                NLP485                NLP486 
##           0.001666667           0.000000000           0.000000000 
##                NLP487                NLP488                NLP489 
##           0.001666667           0.006666667           0.003333333 
##                NLP490                NLP491                NLP492 
##           0.001666667           0.000000000           0.078333333 
##                NLP493                NLP494                NLP495 
##           0.031666667           0.000000000           0.010000000 
##                NLP496                NLP497                NLP498 
##           0.000000000           0.003333333           0.010000000 
##                NLP499                NLP500                NLP501 
##           0.001666667           0.013333333           0.001666667 
##                NLP502                NLP503                NLP504 
##           0.000000000           0.000000000           0.000000000 
##                NLP505                NLP506                NLP507 
##           0.028333333           0.008333333           0.016666667 
##                NLP508                NLP509                NLP510 
##           0.001666667           0.003333333           0.003333333 
##                NLP511                NLP512                NLP513 
##           0.000000000           0.003333333           0.003333333 
##                NLP514                NLP515                NLP516 
##           0.001666667           0.005000000           0.026666667 
##                NLP517                NLP518                NLP519 
##           0.005000000           0.000000000           0.008333333 
##                NLP520                NLP521                NLP522 
##           0.006666667           0.001666667           0.008333333 
##                NLP523                NLP524                NLP525 
##           0.005000000           0.000000000           0.006666667 
##                NLP526                NLP527                NLP528 
##           0.000000000           0.000000000           0.000000000 
##                NLP529                NLP530                NLP531 
##           0.005000000           0.015000000           0.005000000 
##                NLP532                NLP533                NLP534 
##           0.005000000           0.001666667           0.010000000 
##                NLP535                NLP536                NLP537 
##           0.048333333           0.496666667           0.001666667 
##                NLP538                NLP539                NLP540 
##           0.025000000           0.011666667           0.000000000 
##                NLP541                NLP542                NLP543 
##           0.055000000           0.008333333           0.010000000 
##                NLP544                NLP545                NLP546 
##           0.005000000           0.000000000           0.000000000 
##                NLP547                NLP548                NLP549 
##           0.000000000           0.001666667           0.000000000 
##                NLP550                NLP551                NLP552 
##           0.001666667           0.006666667           0.000000000 
##                NLP553                NLP554                NLP555 
##           0.000000000           0.003333333           0.030000000 
##                NLP556                NLP557                NLP558 
##           0.000000000           0.020000000           0.003333333 
##                NLP559                NLP560                NLP561 
##           0.000000000           0.003333333           0.001666667 
##                NLP562                NLP563                NLP564 
##           0.001666667           0.000000000           0.010000000 
##                NLP565                NLP566                NLP567 
##           0.001666667           0.001666667           0.000000000 
##                NLP568                NLP569                NLP570 
##           0.005000000           0.043333333           0.015000000 
##                NLP571                NLP572                NLP573 
##           0.003333333           0.003333333           0.275000000 
##                NLP574 healthcare_utlization 
##           0.000000000           0.000000000 
## attr(,"class")
## [1] "PhecapFeatureExtraction"</code></pre>
<p>Train phenotyping model and show the fitted model, with the AUC on the training set as well as random splits.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phecap_train_phenotyping_model.html">phecap_train_phenotyping_model</a></span>(data, surrogates, feature_selected)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co"># print(model)</span></a></code></pre></div>
<p>Validate phenotyping model using validation label, and show the AUC and ROC.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">validation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phecap_validate_phenotyping_model.html">phecap_validate_phenotyping_model</a></span>(data, surrogates, model)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># print(validation)</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw"><a href="../reference/phecap_plot_roc_curves.html">phecap_plot_roc_curves</a></span>(validation)</a></code></pre></div>
<p>Apply the model to all the patients to obtain predicted phenotype.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">phenotype &lt;-<span class="st"> </span><span class="kw"><a href="../reference/phecap_predict_phenotype.html">phecap_predict_phenotype</a></span>(data, surrogates, model)</a></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Yichi Zhang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
